# Tutorials

VPN_Wireguard

Introduction
This document outlines the configuration steps for setting up a VPN (Virtual Private Network) using WireGuard, and connecting that VPN to your Unifi UDM Pro as a client. 
Utilizing WireGuard on my  UniFi Dream Machine Pro (UDM Pro) for my VPN provides a seamless and secure way to access my home network. This opened up the UDM Pro's advanced features, including one-click VPN setup. Additionally, Ubiquiti offers Teleport, seperate solution from wireguard, it allows remote access to your UDM Pro network from anywhere,these two solutions are awesomi f you are trying to access your home network on the go. 

 I use a cloud provider name Linode to host my wireguard VPN server. Linode makes easy to spin up a node. Make sure to attach your ssh keys to your server for external access. 

 ![Linode](https://github.com/welsblanchard/VPN_Wireguard/assets/166959331/109eb8df-0d71-4729-a6af-db79aa9d8581)


Linode does offer a server with wireguard already install but at the time I was installing it, it was very buggy 
![linodemarketplace](https://github.com/welsblanchard/VPN_Wireguard/assets/166959331/44611ed6-689d-4bf9-aeaf-485f13847398)


Here are the steps I took to install it manually on ubuntu 22.04
Installation
Install WireGuard: Ubuntu server command line commands 
- sudo apt update
- sudo apt install wireguard

1. Generate Server Key Pair:
Generate private and public keys for the server:
- wg genkey | sudo tee /etc/wireguard/privatekey | wg pubkey | sudo tee /etc/wireguard/publickey
  
2. Ensure proper permissions:
- sudo chmod 600 /etc/wireguard/privatekey


3. Create Configuration File:
- Create a new configuration file, for example, /etc/wireguard/wg0.conf:
    - sudo nano /etc/wireguard/wg0.conf

 
4. Add the following content to the file, replacing <SERVER_PRIVATE_KEY> and <SERVER_PUBLIC_KEY> with the respective keys generated earlier:\
- Here is how the config file will look like

Here is one of mine
![wireguardconf](https://github.com/welsblanchard/VPN_Wireguard/assets/166959331/73a11e81-ebaf-4ce0-a600-62b0e36dd908)

here is a generic version generated by my local llama 3 AI
- ![default wireguard config file](https://github.com/welsblanchard/VPN_Wireguard/assets/166959331/f736fdd2-2698-4eb2-a6b7-d11f1916fd32)


5. Configure Firewall:
- open the WireGuard port (default: UDP 51820) on your firewall, note I did not use that port. 
  - sudo ufw allow 51820/udp (ufw is a statefull firewall ) 

6. Start WireGuard Service:
- Enable and start the WireGuard service:
  - sudo systemctl enable wg-quick@wg0
  - sudo systemctl start wg-quick@wg0
 
7. Client Configuration
- My client was my UDM pro and Unifi makes it very easy. This is such a great integration right in the router where I can specify routing for different devices on my network. One cool I notice using Unifi and proxmox as my type 1 hypervisors, I was able to route specific VM's on my Proxmox Hypervisor, this is slightly involve and requires a NIC with more than 2 ports but it is worth it.
![unifivpnconfig](https://github.com/welsblanchard/VPN_Wireguard/assets/166959331/cbc7aa61-5115-48eb-b6be-9d04a99010e2)

8. Generate Client Key Pair:
- Generate private and public keys for the client:
  - wg genkey | tee client_privatekey | wg pubkey > client_publickey

9. Add Client Peer to Server Configuration:
- Add the client's public key to the server configuration (/etc/wireguard/wg0.conf) under the [Peer] section.
- Configure the allowed IP addresses for the client.

10. Create Client Configuration File:
- Create a new configuration file for the client, for example, client.conf.
  - Add the following content, replacing <SERVER_PUBLIC_KEY> with the server's public key and <CLIENT_PRIVATE_KEY> and <CLIENT_PUBLIC_KEY> with the respective keys generated earlier:

11. Import Client Configuration:
- This is where I imported the UDM pro configuration into the Wireguard client.conf

12. Identity
![IAM](https://github.com/welsblanchard/VPN_Wireguard/assets/166959331/e93a22dc-eef7-43bf-8303-283467fd9831)


12. Troubleshooting
- I used the wireguard official website
   - https://www.wireguard.com/
 
- Verify Configuration files for syntax errors

- CVerify publix keys and network interfaces


Bitwarden Turorials 

- I decided to self-host my Bitwarden password manager for several reasons. Firstly, it offers cost-effectiveness, as I can avoid recurring subscription fees associated with third-party services. Additionally, self-hosting provides the benefit of offline access, ensuring I can access my password vault even when internet connectivity is limited or unavailable. Moreover, hosting Bitwarden on my own server presents a valuable learning opportunity, allowing me to gain hands-on experience in server administration, containerization, and security practices. However, self-hosting does come with its challenges. Bitwarden can experience occasional downtime, typically ranging from 5 to 10 times a year, necessitating troubleshooting to resolve issues promptly. One of the most significant challenges I encountered was when the database ran out of storage space, resulting in a critical failure. This incident prompted me to learn how to increase disk size on Ubuntu, enhancing my skills in server maintenance and troubleshooting.

- Self hosting Bitwarden is pretty involve here what I used to Install, configure and troubleshoot.
<b> https://bitwarden.com/help/install-on-premise-linux/ </b> 


- Using cloudflare Tunnel
    https://developers.cloudflare.com/cloudflare-one/connections/connect-networks/get-started/create-remote-tunnel/
  
![cloudflare](https://github.com/welsblanchard/Bitwarden/assets/166959331/5cc6fb5a-3ece-4f9f-89e4-54045879442e)


Network 

Networking Documentation for My Home Lab Project
Introduction
This document details the networking setup and topology for the home lab project. I believe Netowrking is the most important part of the homelab. This home lab is designed to simulate a small-scale enterprise network environment for testing and learning purposes.

What I am running on my Proxmox Hypervisor  aka Homelab 
- ![Proxmox HYpervisor VM's ](https://github.com/welsblanchard/Hardware/assets/166959331/448afe7b-0fcd-45ac-8d7b-b54890871567)


Hardware
1. Router/Firewall/IDS
- Model: Ubiquiti Dream Machine Pro (UDM Pro)
- Description: Serves as the primary gateway, firewall, and intrusion detection system (IDS) for the internal network. Manages routing, security, and traffic monitoring functions.
- Configuration: 1. WAN Interface: eth0***      2. LAN Interface: eth1***

3. Switch
- Model: Ubiquiti UniFi Switch 24 (USW-24-POE)
- Description: Provides Power over Ethernet (PoE) and network connectivity for various devices within the internal network.
- Configuration: Ports: 24 x Gigabit Ethernet + 2 x SFP

5. Access Points
- Model: 2 x Ubiquiti UniFi Access Points
- Description: Provide wireless network connectivity for client devices.
- Security: Set to super protected :) 

7. DNS Server
- Model: Pi-hole
<b> A DNS sinkhole that doubles as a network-wide ad blocker. Provides DNS resolution and ad blocking capabilities.</b>
<p> I had a oneboard libre computer collecting dust, I used that to load up the ubuntu server 22.04 arm64 OS </p>
Download Pi-hole:
<p>Download the Pi-hole installation script from the official Pi-hole GitHub repository: </p>
- <b>curl -sSL https://install.pi-hole.net | bash </b>

Follow Installation Wizard:
Execute the installation script and follow the on-screen instructions provided by the Pi-hole installation wizard.
During the installation process, you'll be prompted to configure network settings, <b> select upstream DNS providers, and define blocklists.</b>

setting the Libre oneboard computer to static by editing the neplan YAML file, Edit on the router to use the pi-hole as the primary DNS server. 
![pihole](https://github.com/welsblanchard/Homelab/assets/166959331/be65d44b-53ab-447d-99bf-c59d2d7d5a4f)

- Access Pi-hole Admin Interface:
<p> Once the installation is complete, accessing the Pi-hole Admin Interface by navigating to </p>
http:// [IP_address_of_your_Oneboard_Libre_Computer]/admin in a web browser.

- Log in using the default credentials (admin/admin) or the credentials you specified during installation.

I notice my servers and desktop were getting DNS server failed beacsue the rate limit was a low number, zero means unlimited. 
![ratelimit](https://github.com/welsblanchard/Homelab/assets/166959331/5a62e04e-a99b-407b-905c-03836050aafb)

- Adlist: Firebog.net
![adblockinglist](https://github.com/welsblanchard/Homelab/assets/166959331/b06224f8-b4e8-4295-8eaf-24ba4fae182e)

- Test Pi-hole Functionality:
Verify that Pi-hole is functioning correctly by visiting websites known to contain advertisements.
Confirm that ads are blocked, and the Pi-hole Admin Interface displays statistics showing blocked requests.
![ADTestingTool](https://github.com/welsblanchard/Network/assets/166959331/3d34987c-5424-4295-aade-7f50d3f1ad83)



8. Suricata IDS
- Description: An open-source intrusion detection and prevention system for monitoring network traffic.
- Explanation can be found under the cybersecurity projects.
![suricataIDS](https://github.com/welsblanchard/Homelab/assets/166959331/e7ed68ec-0beb-48c6-9da6-5aba6a70bfcf)


- Topology
Network Diagram
![network diagram ](https://github.com/welsblanchard/Hardware/assets/166959331/025caad9-0258-4cc9-aed4-23867f8fab76)


![network2](https://github.com/welsblanchard/Hardware/assets/166959331/af20a62c-6e1d-404b-ab58-dd69cfc3df3f)

Network segmentation is crucial for enhancing security and optimizing network performance. By dividing the network into smaller segments, I can limit the impact of security breaches and control access to resources more effectively. Additionally, segmentation helps isolate critical systems and contain security threats within specific segments, ensuring their protection against unauthorized access. 

![network1](https://github.com/welsblanchard/Hardware/assets/166959331/e4a4a09a-77b9-4cb5-8054-e371febbf6f5)


This networking setup, integrated with Pi-hole DNS and Suricata IDS, offers a scalable and secure environment for testing and learning networking concepts within my home lab setting. It allows for experimentation with different network configurations, services, and security mechanisms while maintaining a high level of isolation and control.


Zabbix monitoring 

Zabbix is an open-source monitoring solution designed to track the performance and availability of network devices, servers, applications, and services in real-time. It offers a centralized platform for monitoring, alerting, and visualizing data, allowing to proactively identify and resolve issues before they impact business operations. 


- To install Zabbix, I used this documentation:
<b> https://www.zabbix.com/download?zabbix=6.4&os_distribution=ubuntu&os_version=22.04&components=server_frontend_agent&db=mysql&ws=apache </b> 

![zabbix](https://github.com/welsblanchard/Zabbix-Monitoring-Solution/assets/166959331/7171a9d7-8249-4544-84bd-5a58d60a306d)


![Zabbix2](https://github.com/welsblanchard/Zabbix-Monitoring-Solution/assets/166959331/0ba976b7-35bc-49e4-8c2e-9eb67c5cfe8c)


![zabbix3](https://github.com/welsblanchard/Zabbix-Monitoring-Solution/assets/166959331/d48496bb-acb4-485e-80c0-64703fd4eaf2)



- Using Zabbix to monitor AWS EC2 Instances, S3 Storage, and Cloudtrial logs.

- Insert template
  https://git.zabbix.com/projects/ZBX/repos/zabbix/browse/templates/cloud/AWS/aws_http/template_cloud_aws_http.yaml?at=release%2F6.4
  ![zabbix4](https://github.com/welsblanchard/Zabbix-Monitoring-Solution/assets/166959331/6edc9118-a102-4e7c-b091-4797ed64397f)

- AWS IAM Policy
![AWS1](https://github.com/welsblanchard/Zabbix-Monitoring-Solution/assets/166959331/7d618e50-c776-493d-af5c-bd50e4378043)

  
- Configuring template and Macros
  ![zabbix6](https://github.com/welsblanchard/Zabbix-Monitoring-Solution/assets/166959331/c9f1f860-6db3-4d7f-8290-eb9e72fc3fee)

  
![zabbix5](https://github.com/welsblanchard/Zabbix-Monitoring-Solution/assets/166959331/3ad0e315-b6d6-4c48-9848-70823084225f)



